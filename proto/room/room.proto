syntax = "proto3";
import "playcards/proto/page/page.proto";

package room;

message Room {
    int32 RoomID = 1;
    string Password = 2;
    repeated RoomUser UserList  =3;
    int32 MaxNumber  =4;
    int32 RoundNumber =5;
    int32 RoundNow  =6;
    int32 Status    =7;
    int32 GameType  =8;
        
    string GameParam = 9;
    int64 CreatedAt =10;
    int64 UpdatedAt =11;
    int32 RoomType   = 12;
    int32 PayerID = 13;
}

message RoomUser{
    int32 UserID = 1;
    int32 Ready = 2;
    int32 Position = 3;
    string Icon =4;
    int32 Sex =5;
    int32 Role =6;
    string Nickname = 7;
    int32 RoomID = 8;
    int32 Destroy = 9;
}

message Position {
    int32 RoomID = 1;
    int32 UserID = 2;
    int32 Index = 3;
    bool Ready = 4;
}

message GameUserResult {
    int32 UserID =1;
    int32 Win    =2;
    int32 Lost   =3;
    int32 Tie    =4;
    int32 Score  =5;
    string GameCardCount = 6;
    string Nickname = 7;
}

message RoomResults {
    int32 RoomID = 1;
    int32 RoundNumber = 2;
    int32 RoundNow = 3;
    int32 Status = 4;
    string Password = 5;
    repeated GameUserResult List = 6;
    int64 CreatedAt = 7; 
}

message GiveUpGameRequest {
    string Password = 1;
    int32 AgreeOrNot = 2;
}

message GiveUpGameResult {
    int32 RoomID =1; 
    int32 Status =2; 
    repeated UserState UserStateList = 3;
}

message UserState {
    int32 State = 1;
    int32 UserID = 2;
}

message RenewalRoomReady {
    int32 RoomID = 1;
    string Password = 2;
    int32 Status    =3;
}

message Shock {
    int32 RoomID = 1;
    int32 UserIDFrom = 2;
    int32 UserIDTo = 3;
}

message UserConnection {
    int32 RoomID = 1;
    int32 UserID = 2;
    int32 Status = 3;//1 重连 2掉线
}

message HeartbeatRequest {
    
}

message Renewal {
    string Password = 2;
}

message PageFeedbackListRequest{
    page.PageOption Page = 1;
    Feedback Feedback = 2;
}

message PageFeedbackListReply {
    int32 Result = 1;
    repeated Feedback List = 2;
    int64 Count = 3;
}

message Feedback {
    int32  FeedbackID    =1; 
    int32  UserID        =2;
    string Channel       =3;
    string Version       =4;
    string Content       =5;
    string MobileModel   =6;
    string MobileNetWork =7;
    string MobileOs      =8;
    string LoginIP       =9;
    int64 CreatedAt      =10;
    int64 UpdatedAt      =11;
}

message RoomResultListReply {
    repeated RoomResults List= 1;
}

message CheckRoomExistRequest{
    
}

message CheckRoomExistReply{
    Room Room = 1;
    GiveUpGameResult GiveupResult = 2;
    RoomResults GameResult = 3;
}

message VoiceChat{
    int32   UserID        =1;
    int32   RoomID        =2;
    string  FileCode      =3;
}

message VoiceChatRequest{
    string  FileCode      =3;
}



service RoomSrv {
    rpc CreateRoom(Room) returns (Room) {}
    rpc EnterRoom(Room) returns (Room) {}
    rpc LeaveRoom(Room) returns (RoomUser) {}
    rpc SetReady(Room) returns (RoomUser) {}
    rpc OutReady(Room) returns (RoomUser) {}
    rpc Heartbeat(Room) returns (Room) {}
    rpc TestClean(Room) returns (Room) {}
    rpc GiveUpGame(GiveUpGameRequest) returns (GiveUpGameResult) {}
    rpc Shock(RoomUser) returns (RoomUser) {}
    rpc Renewal(Room) returns (Room) {}
    rpc CreateFeedback(Feedback) returns (Feedback) {}
    rpc PageFeedbackList(PageFeedbackListRequest) returns (PageFeedbackListReply) {}
    rpc RoomResultList(Room) returns (RoomResultListReply) {}
    rpc CheckRoomExist(Room) returns (CheckRoomExistReply) {}
    rpc VoiceChat(VoiceChatRequest) returns (RoomUser) {}
}



